<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="GPlanner.Maui.Pages.TaskModal"
             Title="New Task Page"
             xmlns:viewModel="clr-namespace:GPlanner.Maui.ViewModels"
             x:DataType="viewModel:TaskModalViewModel">
       <ContentPage.ToolbarItems>
              <ToolbarItem Text="Cancel"
                           Command="{Binding CancelCommand}"/>
       </ContentPage.ToolbarItems>

       <ScrollView>
              <StackLayout Padding="20"
                           Spacing="15">
                     <Label Text="Task Title"
                            FontSize="16"
                            FontAttributes="Bold"
                            HorizontalOptions="Start"/>
                     <Border StrokeThickness="1"
                             Stroke="#CCCCCC"
                             StrokeShape="RoundRectangle 20,20,20,20">
                            <Entry Placeholder="Task Title"
                                   Text="{Binding ActiveTask.Title}"/>
                     </Border>

                     <Label Text="Description"
                            Style="{StaticResource TitleLabelStyle}"/>
                     <Border StrokeThickness="1"
                             Stroke="#CCCCCC"
                             StrokeShape="RoundRectangle 20,20,20,20">
                            <Editor Placeholder="Details about the task..."
                                    Text="{Binding ActiveTask.Description}"
                                    HeightRequest="100"
                                    Style="{StaticResource InputEntryStyle}"/>
                     </Border>

                     <Label Text="Task Type"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="#202124"/>
                     <Border StrokeThickness="1"
                             Stroke="#CCCCCC"
                             StrokeShape="RoundRectangle 20,20,20,20">
                            <Picker Title="Select Task Type"
                                    SelectedItem="{Binding ActiveTask.Type, Mode=TwoWay}"
                                    ItemsSource="{Binding TaskTypes}"
                                    TextColor="#202124"
                                    FontSize="16"
                                    BackgroundColor="Transparent"/>
                     </Border>

                     <!-- ðŸŸ¢ FIX: Binding Label directly to the Priority property -->
                     <Label Text="{Binding ActiveTask.Priority, StringFormat='Priority : {0:F0}'}"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="#202124"/>

                     <Slider Minimum="1"
                             Maximum="5"
                             x:Name="prioritySlider"
                             Value="{Binding ActiveTask.Priority, Mode=TwoWay}"
                             MinimumTrackColor="#1A73E8"
                             MaximumTrackColor="#E8EAED"/>

                     <Label Text="Due Date"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="#202124"/>
                     <Border StrokeThickness="1"
                             Stroke="#CCCCCC"
                             StrokeShape="RoundRectangle 20,20,20,20">
                            <DatePicker Date="{Binding ActiveTask.Date}"
                                        Format="ddd, MMM dd, yyyy"
                                        TextColor="#202124"
                                        FontSize="16"/>
                     </Border>


                     <Label Text="Due Time"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="#202124"/>
                     <Border StrokeThickness="1"
                             Stroke="#CCCCCC"
                             StrokeShape="RoundRectangle 20,20,20,20">
                            <TimePicker Time="{Binding NewTaskTime}"
                                        TextColor="#202124"
                                        FontSize="16"/>
                     </Border>

                     <Button Command="{Binding AddOrSaveCommand}"
                             Text="{Binding IsEditMode, Converter={StaticResource BoolToTextConverter}, ConverterParameter='Save|Create'}"
                             BackgroundColor="#6A5ACD"
                             TextColor="White"
                             FontAttributes="Bold"
                             CornerRadius="10"
                             HeightRequest="50"/>
              </StackLayout>
       </ScrollView>
</ContentPage>